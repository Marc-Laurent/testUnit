language: node_js

node_js:
  - '10'
  - '9'
  - '8'

# échoue dès qu'une erreur intervient
matrix:
  fast_finish: true

# met en cache node_modules, à noter que dans ce genre d’utilisation pour des
# bibliothèques open source consommées via npm, il ne faudra pas oublier
# des paquets encore en cache mais non présents dans le package.json
cache:
  directories:
    - node_modules

# before_install:
#   - npm build

# Les commandes à utiliser avec le script
before_script:


# si on veut utiliser autre chose que la commande par défaut
script:
  - npm run test

#  les test passe on lance :
after_success: 'npm start'

# on déploie les commits sur la
# branche master uniquement pour une version de node
# à décommenter si le fichier deploy est crée
deploy:
  skip_cleanup: true
  provider: script
  script: ./scripts/deploy.sh
  on:
    branch: master
    node: '10'

# variables d'env
# env:
#   global:
#     - NODE_ENV=production
